// Copyright 2022 The Fuchsia Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
{
    actions: [
        {
            type: "expect_pass",
            matchers: [
                "*",
            ],
        },
        {
            type: "expect_failure",
            matchers: [
                // Netstack3 does not support SO_REUSEADDR and only partially supports
                // SO_REUSEPORT for UDP sockets.
                "AllUDPSockets/UDPSocketPairTest.ReuseAddrDefault/*",
                "AllUDPSockets/UDPSocketPairTest.SetReuseAddr/*",
                "AllUDPSockets/UDPSocketPairTest.SetReuseAddrReusePort/*",
                "AllUDPSockets/UDPSocketPairTest.SetReusePort/*",
                "UdpInet6SocketTest.ConnectInet4Sockaddr",
                "UdpBindTest/SendtoTest.Sendto/0",
                "UdpBindTest/SendtoTest.Sendto/3",
                "UdpBindTest/SendtoTest.Sendto/4",
                "UdpBindTest/SendtoTest.Sendto/5",
                "UdpBindTest/SendtoTest.Sendto/6",
                "UdpBindTest/SendtoTest.Sendto/8",
                "UdpBindTest/SendtoTest.Sendto/9",
            ],
        },
        {
            type: "skip",
            matchers: [
                // Tests that flake in Fuchsia's CQ.
                // https://fxbug.dev/115961
                "AllInetTests/UdpSocketTest.SendToAddressOtherThanConnected/*",

                // Cases are either skipped entirely (0, 1) or fail (2)
                "AllInetTests/UdpSocketControlMessagesTest.SendAndReceiveTOSorTClass/*",

                // Tests that hang in Fuchsia's CQ due to indefinite poll for ICMP response.
                // TODO(https://fxbug.dev/47321): Implement ICMP sockets in Netstack3.
                "AllInetTests/UdpSocketTest.ConnectWriteToInvalidPort/*",
                "AllInetTests/UdpSocketTest.ConnectAndSendNoReceiver/*",
            ],
        },
        {
            type: "expect_failure",
            matchers: [
                "AllInetTests/UdpSocketTest.ConnectToZeroPortBound/*",
                "AllInetTests/UdpSocketTest.ConnectToZeroPortConnected/*",
                "AllInetTests/UdpSocketTest.ConnectToZeroPortUnbound/*",
                "AllInetTests/UdpSocketTest.DisconnectAfterBindToAny/*",
                "AllInetTests/UdpSocketTest.DisconnectAfterBindToUnspecAndConnect/*",
                "AllInetTests/UdpSocketTest.DisconnectAfterConnectAnyWithPort/*",
                "AllInetTests/UdpSocketTest.DisconnectAfterConnectWithoutBind/*",
                "AllInetTests/UdpSocketTest.FIONREADShutdown/*",
                "AllInetTests/UdpSocketTest.FIONREADWriteShutdown/*",
                "AllInetTests/UdpSocketTest.FIONREADZeroLengthPacket/*",
                "AllInetTests/UdpSocketTest.FIONREADZeroLengthWriteShutdown/*",
                "AllInetTests/UdpSocketTest.Fionread/*",
                "AllInetTests/UdpSocketTest.Getpeername/*",
                "AllInetTests/UdpSocketTest.Getsockname/*",
                "AllInetTests/UdpSocketTest.ReadShutdownNonblockPendingData/*",
                "AllInetTests/UdpSocketTest.RecvBufLimits/*",
                "AllInetTests/UdpSocketTest.SendPacketLargerThanSendBufOnNonBlockingSocket/*",
                "AllInetTests/UdpSocketTest.SoNoCheck/*",
                "AllInetTests/UdpSocketTest.SoNoCheckOffByDefault/*",
                "AllInetTests/UdpSocketTest.SoTimestamp/*",
                "AllInetTests/UdpSocketTest.SoTimestampOffByDefault/*",
                "AllInetTests/UdpSocketTest.TimestampIoctl/*",
                "AllInetTests/UdpSocketTest.TimestampIoctlNothingRead/*",
                "AllInetTests/UdpSocketTest.TimestampIoctlPersistence/*",

                // Netstack3 does not support many UDP socket options or operations
                "AllUDPSockets/AllSocketPairTest.BasicRecvmmsg/*",
                "AllUDPSockets/AllSocketPairTest.BasicSendmmsg/*",
                "AllUDPSockets/AllSocketPairTest.GetSndBufSucceeds/*",
                "AllUDPSockets/AllSocketPairTest.GetSocketOutOfBandInlineOption/*",
                "AllUDPSockets/AllSocketPairTest.GetSocketRcvbufOption/*",
                "AllUDPSockets/AllSocketPairTest.KeepAliveSocketOption/*",
                "AllUDPSockets/AllSocketPairTest.LingerSocketOption/*",
                "AllUDPSockets/AllSocketPairTest.RecvmmsgInvalidTimeout/*",
                "AllUDPSockets/AllSocketPairTest.RecvmmsgTimeoutBeforeRecv/*",
                "AllUDPSockets/AllSocketPairTest.RecvmsgMsghdrFlagsCleared/*",
                "AllUDPSockets/AllSocketPairTest.SendmmsgIsLimitedByMAXIOV/*",
                "AllUDPSockets/AllSocketPairTest.RecvmsgPeekMsghdrFlagsCleared/*",
                "AllUDPSockets/AllSocketPairTest.SetAndGetBooleanSocketOptions/*",
                "AllUDPSockets/NonStreamSocketPairTest.SendMsgTooLarge/*",
                "AllUDPSockets/UDPSocketPairTest.GetSocketAcceptConn/*",
                "AllUDPSockets/UDPSocketPairTest.IPPKTINFODefault/*",
                "AllUDPSockets/UDPSocketPairTest.RecvTosDefault/*",
                "AllInetTests/UdpSocketControlMessagesTest.SendAndReceiveTTLOrHopLimit/*",
                "AllInetTests/UdpSocketControlMessagesTest.SetAndReceivePktInfo/*",
                "AllInetTests/UdpSocketControlMessagesTest.SetAndReceiveTOSOrTClass/*",
                "AllInetTests/UdpSocketControlMessagesTest.SetAndReceiveTTLOrHopLimit/*",
                "AllUDPSockets/UDPSocketPairTest.TOSRecvMismatch/*",

                // Expect failure for dual-stack UDP sockets.
                "AllUDPSockets/AllSocketPairTest.BasicReadWrite/[25]",
                "AllUDPSockets/AllSocketPairTest.BasicReadWriteBadBuffer/[25]",
                "AllUDPSockets/AllSocketPairTest.BasicSendRecv/[25]",
                "AllUDPSockets/AllSocketPairTest.GetSockoptType/[25]",
                "AllUDPSockets/AllSocketPairTest.RecvTimeoutDefault/[25]",
                "AllUDPSockets/AllSocketPairTest.RecvTimeoutNegSecRead/[25]",
                "AllUDPSockets/AllSocketPairTest.RecvTimeoutNegSecRecv/[25]",
                "AllUDPSockets/AllSocketPairTest.RecvTimeoutNegSecRecvmsg/[25]",
                "AllUDPSockets/AllSocketPairTest.RecvTimeoutReadSucceeds/[25]",
                "AllUDPSockets/AllSocketPairTest.RecvTimeoutRecvOneSecondSucceeds/[25]",
                "AllUDPSockets/AllSocketPairTest.RecvTimeoutRecvSucceeds/[25]",
                "AllUDPSockets/AllSocketPairTest.RecvTimeoutRecvmsgOneSecondSucceeds/[25]",
                "AllUDPSockets/AllSocketPairTest.RecvTimeoutRecvmsgSucceeds/[25]",
                "AllUDPSockets/AllSocketPairTest.RecvTimeoutUsecNeg/[25]",
                "AllUDPSockets/AllSocketPairTest.RecvTimeoutUsecTooLarge/[25]",
                "AllUDPSockets/AllSocketPairTest.RecvTimeoutWaitAll/[25]",
                "AllUDPSockets/AllSocketPairTest.RecvWaitAll/[25]",
                "AllUDPSockets/AllSocketPairTest.RecvWaitAllDontWait/[25]",
                "AllUDPSockets/AllSocketPairTest.RecvmsgIovNotUpdated/[25]",
                "AllUDPSockets/AllSocketPairTest.RecvmsgMsghdrFlagsNotClearedOnFailure/[25]",
                "AllUDPSockets/AllSocketPairTest.SendTimeoutAllowsSend/[25]",
                "AllUDPSockets/AllSocketPairTest.SendTimeoutAllowsSendmsg/[25]",
                "AllUDPSockets/AllSocketPairTest.SendTimeoutAllowsWrite/[25]",
                "AllUDPSockets/AllSocketPairTest.SendTimeoutDefault/[25]",
                "AllUDPSockets/AllSocketPairTest.SendTimeoutUsecNeg/[25]",
                "AllUDPSockets/AllSocketPairTest.SendTimeoutUsecTooLarge/[25]",
                "AllUDPSockets/AllSocketPairTest.SendmsgRecvmsg10KB/[25]",
                "AllUDPSockets/AllSocketPairTest.SendmsgRecvmsg16KB/[25]",
                "AllUDPSockets/AllSocketPairTest.SendmsgRecvmsgMsgCtruncNoop/[25]",
                "AllUDPSockets/AllSocketPairTest.SetGetRecvTimeout/[25]",
                "AllUDPSockets/AllSocketPairTest.SetGetRecvTimeoutLargerArg/[25]",
                "AllUDPSockets/AllSocketPairTest.SetGetSendTimeout/[25]",
                "AllUDPSockets/AllSocketPairTest.SetGetSendTimeoutLargerArg/[25]",
                "AllUDPSockets/NonStreamSocketPairTest.MsgTruncNotFull/[25]",
                "AllUDPSockets/NonStreamSocketPairTest.MsgTruncSameSize/[25]",
                "AllUDPSockets/NonStreamSocketPairTest.MsgTruncTruncation/[25]",
                "AllUDPSockets/NonStreamSocketPairTest.MsgTruncTruncationRecvmsgMsghdrFlagMsgTrunc/[25]",
                "AllUDPSockets/NonStreamSocketPairTest.RecvmsgMsgTruncZeroLen/[25]",
                "AllUDPSockets/NonStreamSocketPairTest.RecvmsgMsghdrFlagMsgTrunc/[25]",
                "AllUDPSockets/NonStreamSocketPairTest.RecvmsgTruncPeekDontwaitZeroLen/[25]",
                "AllUDPSockets/NonStreamSocketPairTest.SingleRecv/[25]",
                "AllUDPSockets/NonStreamSocketPairTest.SplitRecv/[25]",
                "AllUDPSockets/UDPSocketPairTest.SetUDPMulticastTTLAboveMax/[25]",
                "AllUDPSockets/UDPSocketPairTest.SetUDPMulticastTTLBelowMin/[25]",
                "AllUDPSockets/AllSocketPairTest.RcvBufSucceeds/[25]",
                "AllUDPSockets/AllSocketPairTest.GetSockoptDomain/[25]",
                "AllUDPSockets/AllSocketPairTest.GetSockoptProtocol/[25]",
                "AllUDPSockets/UDPSocketPairTest.ReusePortDefault/[25]",
                "AllUDPSockets/AllSocketPairTest.MsgPeek/[25]",
                "AllUDPSockets/NonStreamSocketPairTest.SinglePeek/[25]",
                "AllUDPSockets/NonStreamSocketPairTest.RecvmsgMsgTruncMsgPeekZeroLen/[25]",

                // Expect failure for setting TTL on non-IPv4 sockets.
                "AllUDPSockets/UDPSocketPairTest.MulticastTTLDefault/[0235]",
                "AllUDPSockets/UDPSocketPairTest.SetUDPMulticastTTLNegativeOne/[0235]",
                "AllUDPSockets/UDPSocketPairTest.SetUDPMulticastTTLChar/[0235]",
                "AllUDPSockets/UDPSocketPairTest.SetUDPMulticastTTLMax/[0235]",

                // Netstack3 does not have complete support for multicast UDP sockets.
                "AllUDPSockets/UDPSocketPairTest.MulticastLoopDefault/*",
                "AllUDPSockets/UDPSocketPairTest.SetMulticastLoop/*",
                "AllUDPSockets/UDPSocketPairTest.SetMulticastLoopChar/*",
                "AllUDPSockets/UDPSocketPairTest.SetUDPMulticastTTLMin/*",
                "AllUDPSockets/UDPSocketPairTest.SetEmptyIPAddMembership/0",
                "AllUDPSockets/UDPSocketPairTest.SetEmptyIPAddMembership/2",
                "AllUDPSockets/UDPSocketPairTest.SetEmptyIPAddMembership/3",
                "AllUDPSockets/UDPSocketPairTest.SetEmptyIPAddMembership/5",

                // Uncategorized
                "AllUDPSockets/UDPSocketPairTest.ReceiveOrigDstAddrDefault/*",
                "AllUDPSockets/UDPSocketPairTest.SetAndGetIPPKTINFO/*",
                "AllUDPSockets/UDPSocketPairTest.SetAndGetReceiveOrigDstAddr/*",
                "AllUDPSockets/UDPSocketPairTest.SetAndGetSocketLinger/*",
                "AllUDPSockets/UDPSocketPairTest.SetRecvTos/*",

                // https://fxbug.dev/74639
                "AllUDPSockets/AllSocketPairTest.GetSetSocketRcvlowatOption/*",
            ],
        },
    ],
}
