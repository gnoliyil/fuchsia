// Copyright 2023 The Fuchsia Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.

#include "src/devices/bin/driver_manager/devfs/allowlist.h"

#include <unordered_set>

bool AllowMultiplexingController(std::string_view class_name) {
  // TODO(https://fxbug.dev/115995): Remove entries from this list.
  static const std::unordered_set<std::string_view> classes_that_include_controller({
      "block",
      "block-impl",
      "block-partition",
      "block-volume",
      "codec",
      "device",
      "display-controller",
      "dotmatrix-display",
      "ethernet",
      "ethernet-impl",
      "framebuffer",
      "goldfish-address-space",
      "goldfish-pipe",
      "i2c-impl",
      "acpi",
      "pci",
      "usb-device",
      "usb-dci",
      "usb-peripheral",
      "usb-function",
      "usb-cache-test",
      "usb-hci",
      "usb-mode-switch",
      "usb-dbc",
      "usb-tester",
      "usb-fwloader",
      "bt-hci",
      "bt-emulator",
      "bt-transport",
      "bt-host",
      "bt-gatt-svc",
      "audio",
      "midi",
      "sdhci",
      "sdmmc",
      "sdio",
      "wlanphy",
      "wlanphy-impl",
      "wlan-fullmac",
      "wlan-fullmac-impl",
      "wlan-softmac",
      "camera",
      "isp",
      "virtual-camera-factory",
      "media-codec",
      "battery",
      "power",
      "thermal",
      "gpu-thermal",
      "pty",
      "intel-hda",
      "intel-hda-codec",
      "intel-hda-dsp",
      "test",
      "test-compat-child",
      "test-power-child",
      "platform-dev",
      "i2c-hid",
      "serial",
      "serial-impl",
      "shared-dma",
      "clock-impl",
      "intel-gpu-core",
      "iommu",
      "nand",
      "rawnand",
      "backlight",
      "skip-block",
      "qmi-transport",
      "light",
      "usb-phy",
      "gpu",
      "rtc",
      "tee",
      "vsock",
      "sysmem",
      "mlg",
      "zxcrypt",
      "securemem",
      "tdh",
      "serial-impl-async",
      "cpu-ctrl",
      "network",
      "ot-radio",
      "input-report-inject",
      "usb-hci-test",
      "acpi-device",
      "virtual-bus-test",
      "test-asix-function",
      "audio-input",
      "audio-output",
      "aml-ram",
      "gpu-performance-counters",
      "temperature",
      "vreg",
      "adc",
      "bt-vendor",
      "dsi-base",
      "power-sensor",
      "registers",
      "dai",
      "goldfish-sync",
      "radar",
      "gpu-dependency-injection",
      "tpm-impl",
      "tpm",
      "chromeos-acpi",
      "ctap",
      "aml-mailbox",
      "adb",
  });
  return classes_that_include_controller.find(class_name) != classes_that_include_controller.end();
}

bool AllowMultiplexingNode(std::string_view class_name) {
  // TODO(https://fxbug.dev/115995): Remove entries from this list.
  static const std::unordered_set<std::string_view> classes_that_include_node({
      "block",
      "block-impl",
      "block-partition",
      "block-volume",
      "codec",
      "device",
      "display-controller",
      "dotmatrix-display",
      "ethernet",
      "ethernet-impl",
      "framebuffer",
      "goldfish-address-space",
      "goldfish-pipe",
      "i2c-impl",
      "acpi",
      "pci",
      "usb-device",
      "usb-dci",
      "usb-peripheral",
      "usb-function",
      "usb-cache-test",
      "usb-hci",
      "usb-mode-switch",
      "usb-dbc",
      "usb-tester",
      "usb-fwloader",
      "bt-hci",
      "bt-emulator",
      "bt-transport",
      "bt-host",
      "bt-gatt-svc",
      "audio",
      "midi",
      "sdhci",
      "sdmmc",
      "sdio",
      "wlanphy",
      "wlanphy-impl",
      "wlan-fullmac",
      "wlan-fullmac-impl",
      "wlan-softmac",
      "camera",
      "isp",
      "virtual-camera-factory",
      "media-codec",
      "battery",
      "power",
      "thermal",
      "gpu-thermal",
      "pty",
      "intel-hda",
      "intel-hda-codec",
      "intel-hda-dsp",
      "test",
      "test-compat-child",
      "test-power-child",
      "platform-dev",
      "i2c-hid",
      "serial",
      "serial-impl",
      "shared-dma",
      "clock-impl",
      "intel-gpu-core",
      "iommu",
      "nand",
      "rawnand",
      "backlight",
      "skip-block",
      "qmi-transport",
      "light",
      "usb-phy",
      "gpu",
      "rtc",
      "tee",
      "vsock",
      "sysmem",
      "mlg",
      "zxcrypt",
      "securemem",
      "tdh",
      "serial-impl-async",
      "cpu-ctrl",
      "network",
      "ot-radio",
      "input-report-inject",
      "usb-hci-test",
      "acpi-device",
      "virtual-bus-test",
      "test-asix-function",
      "audio-input",
      "audio-output",
      "aml-ram",
      "gpu-performance-counters",
      "temperature",
      "vreg",
      "adc",
      "bt-vendor",
      "dsi-base",
      "power-sensor",
      "registers",
      "dai",
      "goldfish-sync",
      "radar",
      "gpu-dependency-injection",
      "tpm-impl",
      "tpm",
      "chromeos-acpi",
      "ctap",
      "aml-mailbox",
      "adb",
  });
  return classes_that_include_node.find(class_name) != classes_that_include_node.end();
}
